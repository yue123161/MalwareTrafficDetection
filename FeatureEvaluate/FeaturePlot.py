
import glob
import numpy as np
import matplotlib.pyplot as plt

def read_features(feature_set_path):
    """
    read feature data into a list
    :param feature_set_path: the folder which keeps feature files
    :return: list: features, target
    """
    features = list()
    target = list()
    feature_paths = glob.glob(feature_set_path + "\\*")

    for path in feature_paths:
        with open(path) as f:
            for line in f:
                feature = list()
                split = line.split('\t')
                for cof in split:
                    if 'normal' in cof:
                        target.append('normal')
                    elif 'botnet' in cof:
                        target.append('botnet')
                    else:
                        feature.append(float(cof))
                features.append(feature)
            f.close()

    return features, target


feature_set_path = "D:\\Work\PyCharm-workspace\\MalwareTrafficDetection\\Dataset\\features"
features, target = read_features(feature_set_path)
target_botnet = []
target_normal = []
features_botnet = []
features_normal = []
for i in range(0,len(target)):
    if target[i]=='botnet':
        target_botnet.append(target[i])
        features_botnet.append(features[i])
    else:
        target_normal.append(target[i])
        features_normal.append(features[i])

features_botnet = np.array(features_botnet)
features_normal = np.array(features_normal)

#-----------------------------------------------------------------
#conn_duration: mean/standard deviation/standard deviation range
plt.figure(1)

plt.subplot(5,1,1)
plt.title('CONN Duration Mean')
plt.xlabel('time/ms')
plt.plot(features_normal[:,0], target_normal, '.')
plt.plot(features_botnet[:,0], target_botnet, '.')

plt.subplot(5,1,3)
plt.title('CONN Duration Standard Deviation')
plt.xlabel('time/ms')
plt.plot(features_normal[:,1], target_normal, '.')
plt.plot(features_botnet[:,1], target_botnet, '.')

plt.subplot(5,1,5)
plt.title('CONN Duration Standard Deviation Range')
plt.xlabel('percentage')
plt.plot(features_normal[:,2], target_normal, '.')
plt.plot(features_botnet[:,2], target_botnet, '.')

#-----------------------------------------------------------------
#conn_orig_bytes: mean/standard deviation/standard deviation range
plt.figure(2)

plt.subplot(5,1,1)
plt.title('CONN Original Bytes Mean')
plt.xlabel('time/ms')
plt.plot(features_normal[:,3], target_normal, '.')
plt.plot(features_botnet[:,3], target_botnet, '.')

plt.subplot(5,1,3)
plt.title('CONN Original Bytes Standard Deviation')
plt.xlabel('time/ms')
plt.plot(features_normal[:,4], target_normal, '.')
plt.plot(features_botnet[:,4], target_botnet, '.')

plt.subplot(5,1,5)
plt.title('CONN Original Bytes Standard Deviation Range')
plt.xlabel('percentage')
plt.plot(features_normal[:,5], target_normal, '.')
plt.plot(features_botnet[:,5], target_botnet, '.')

#-----------------------------------------------------------------
#conn_resp_bytes: mean/standard deviation/standard deviation range
plt.figure(3)

plt.subplot(5,1,1)
plt.title('CONN Response Bytes Mean')
plt.xlabel('time/ms')
plt.plot(features_normal[:,6], target_normal, '.')
plt.plot(features_botnet[:,6], target_botnet, '.')

plt.subplot(5,1,3)
plt.title('CONN Response Bytes Standard Deviation')
plt.xlabel('time/ms')
plt.plot(features_normal[:,7], target_normal, '.')
plt.plot(features_botnet[:,7], target_botnet, '.')

plt.subplot(5,1,5)
plt.title('CONN Response Bytes Standard Deviation Range')
plt.xlabel('percentage')
plt.plot(features_normal[:,8], target_normal, '.')
plt.plot(features_botnet[:,8], target_botnet, '.')

#-----------------------------------------------------------------
#conn_orig_bytes_ratio
plt.figure(4)

plt.subplot()
plt.title('CONN Original Bytes/OB+RB')
plt.xlabel('time/ms')
plt.plot(features_normal[:,9], target_normal, '.')
plt.plot(features_botnet[:,9], target_botnet, '.')

plt.show()


