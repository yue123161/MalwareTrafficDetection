
def find_label_from_binetflow(binetflowPath):
    pathSplit = binetflowPath.split('\\')
    datasetName = pathSplit[-2]
    print(">>>find label from ", datasetName)

    infected_ips = {}
    normal_ips = {}

    try:
        with open(binetflowPath) as f:
            for line in f:
                if 'StartTime' in line:
                    continue

                split = line.split(',')
                label = split[14]
                src_address = split[3]

                if "From_Botnet" in label:
                    try:
                        infected_ips[src_address] = infected_ips[src_address] + 1
                    except:
                        infected_ips[src_address] = 1
                elif "From_Normal" in label:
                    try:
                        normal_ips[src_address] = normal_ips[src_address] + 1
                    except:
                        normal_ips[src_address] = 1
            f.close()
            print(">>>In ", datasetName, ", the infected ips are:\n", infected_ips)
            print(">>>In ", datasetName, ", the normal ips are:\n", normal_ips)
    except:
        print(">>>Error: cannot read ", pathSplit[-1])


    return infected_ips, normal_ips


find_label_from_binetflow("D:\Work\PyCharm-workspace\MalwareTrafficDetection\Dataset\CTU-Malware-Capture-Botnet-42\capture20110810.binetflow")




