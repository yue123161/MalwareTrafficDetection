class Unit:
    unit = ""
    # label 1 malware 0 normal
    label = 0

    # connection parameters
    conn_time = []
    uid = []
    ssl_conn = []
    duration = []
    orig_bytes = []
    resp_bytes = []
    orig_pkts = []
    resp_pkts = []
    conn_state = []

    # connection features
    ssl_ratio = 0
    duration_mean = 0
    duration_standard_deviation = 0
    duration_standard_deviation_range = 0
    source_bytes_mean = 0
    source_bytes_standard_deviation = 0
    source_bytes_standard_deviation_range = 0
    response_bytes_mean = 0
    response_bytes_standard_deviation = 0
    response_bytes_standard_deviation_range = 0
    source_bytes_ratio = 0
    inbound_packets_mean = 0
    inbound_packets_standard_deviation = 0
    inbound_packets_standard_deviation_range = 0
    outbound_packets_mean = 0
    outbound_packets_standard_deviation = 0
    outbound_packets_standard_deviation_range = 0
    inbound_packets_ratio = 0
    periodicity_mean = 0
    periodicity_standard_deviation = 0
    periodicity_standard_deviation_range = 0
    established_connection_states_ratio = 0

    #ssl features

    def __init__(self, unit):
        self.unit = unit


    def add_conn_label_log(self, conn_label_line, ssl_flag):
        '''
        add a data line from conn_label.log
        :param conn_label_line: the data line
        :param ssl_flag: 1 ssl 0 non-ssl
        :return:
        '''
        split = conn_label_line.split("\t")
        unit = split[2] + "\t" + split[4] + "\t" + split[5] + "\t" + split[6]
        if not split[21] == "background":
            if self.unit == unit:
                self.conn_time.append(split[0])
                self.uid.append(split[1])
                self.ssl_conn.append(ssl_flag)
                self.duration.append(split[8])
                self.orig_bytes.append(split[9])
                self.resp_bytes.append(split[10])
                if split[11] in ["SF", "S1", "S2", "S3", "RSTO", "RSTR"]:
                    self.conn_state.append(1)
                else:
                    self.conn_state.append(0)
                self.orig_pkts.append(split[16])
                self.resp_pkts.append(split[18])
                if split[21] == "malware":
                    self.label = 1
                elif split[21] == "normal":
                    self.label = 0
            else:
                print(">>>Error: wrong unit")


u = Unit("68.52.88.162	147.32.84.59	6881	tcp")
u.add_conn_label_log("1312962415.742160	Cm4Iyt3EZ8wcV3lhvk	68.52.88.162	49883	147.32.84.59	6881	tcp	-	0.000016	0	0	REJ	-	-	0	Sr	1	52	1	40	(empty)	malware", 0)
print(u.unit)
print(u.conn_time)
print(u.conn_state)
print(u.ssl_conn)
print(u.label)