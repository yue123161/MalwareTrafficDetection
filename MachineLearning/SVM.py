
import ReadFeatures
from sklearn import svm

feature_set_path = "D:\\Work\PyCharm-workspace\\MalwareTrafficDetection\\Dataset\\features"
features, target = ReadFeatures.read(feature_set_path)

features_normal = []
features_botnet = []
for i in range(0, len(target)):
    if target[i] == 'normal':
        features_normal.append(features[i])
    else:
        features_botnet.append(features[i])

features_normal_train = features_normal[0:int(len(features_normal)*2/3)]
features_botnet_train = features_botnet[0:int(len(features_botnet)*2/3)]
target_train = ['normal']*len(features_normal_train)+['botnet']*len(features_botnet_train)
features_normal_test = features_normal[int(len(features_normal)*2/3):len(features_normal)]
features_botnet_test = features_botnet[int(len(features_botnet)*2/3):len(features_botnet)]
target_test = ['normal']*len(features_normal_test) + ['botnet']*len(features_botnet_test)

clf = svm.SVC()
clf.fit(features_normal_train+features_botnet_train, target_train)
res = clf.predict(features_normal_test+features_botnet_test).tolist()
n = 0
for i in range(0, len(res)):
    if target_test[i] == res[i]:
        n+=1
print(n/len(res))